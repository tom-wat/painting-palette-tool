<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas 2D å…­è§’å½¢ç«‹æ–¹ä½“ãƒ‡ãƒ¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            color: #333;
            text-align: center;
        }
        
        .demo-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .canvas-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }
        
        #demo-canvas {
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: crosshair;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        #color-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            display: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .info-section {
            margin: 20px 0;
            padding: 15px;
            background: #e9ecef;
            border-radius: 4px;
        }
        
        .info-section h3 {
            margin-top: 0;
            color: #495057;
        }
        
        .performance-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .result-card {
            background: white;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        
        .result-card h4 {
            margin-top: 0;
            color: #6f42c1;
        }
        
        .result-value {
            font-size: 24px;
            font-weight: bold;
            color: #28a745;
        }
        
        .result-unit {
            font-size: 14px;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Canvas 2D å…­è§’å½¢ç«‹æ–¹ä½“ - çµµç”»ãƒ‘ãƒ¬ãƒƒãƒˆå¯è¦–åŒ–</h1>
        
        <div class="info-section">
            <h3>ğŸ’¡ ãƒ‡ãƒ¢ã«ã¤ã„ã¦</h3>
            <p>ã“ã®ãƒ‡ãƒ¢ã§ã¯ã€çµµç”»ç”¨è‰²ãƒ‘ãƒ¬ãƒƒãƒˆã‚’å…­è§’å½¢ãƒ™ãƒ¼ã‚¹ã®2Dæ“¬ä¼¼ç«‹æ–¹ä½“ã§è¡¨ç¾ã—ã¾ã™ã€‚</p>
            <ul>
                <li><strong>å…­è§’å½¢ä¸Šé¢</strong>: æœ€ã‚‚æ˜ã‚‹ã„è‰²èª¿ï¼ˆãƒã‚¤ãƒ©ã‚¤ãƒˆï¼‰</li>
                <li><strong>å·¦é¢</strong>: åŸºæœ¬è‰²èª¿ï¼ˆãƒŸãƒƒãƒ‰ãƒˆãƒ¼ãƒ³ï¼‰</li>
                <li><strong>å³é¢</strong>: æœ€ã‚‚æš—ã„è‰²èª¿ï¼ˆã‚·ãƒ£ãƒ‰ã‚¦ï¼‰</li>
                <li><strong>ãƒ›ãƒãƒ¼åŠ¹æœ</strong>: ç«‹æ–¹ä½“ã«ãƒã‚¦ã‚¹ã‚’é‡ã­ã‚‹ã¨æ‹¡å¤§è¡¨ç¤º</li>
            </ul>
        </div>

        <div class="demo-section">
            <h2>ğŸ¨ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¢</h2>
            
            <div class="canvas-container">
                <canvas id="demo-canvas" width="800" height="600"></canvas>
            </div>
            
            <div class="controls">
                <button id="grid-layout">ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</button>
                <button id="circular-layout">å††å½¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</button>
                <button id="animated-demo">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¢</button>
                <button id="stop-animation" disabled>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åœæ­¢</button>
                <button id="random-palette">ãƒ©ãƒ³ãƒ€ãƒ ãƒ‘ãƒ¬ãƒƒãƒˆ</button>
                <button id="performance-test">æ€§èƒ½ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµæœ</h2>
            <div id="performance-results" class="performance-results">
                <div class="result-card">
                    <h4>æç”»æ€§èƒ½</h4>
                    <div class="result-value" id="render-time">-</div>
                    <div class="result-unit">ms</div>
                </div>
                <div class="result-card">
                    <h4>ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆ</h4>
                    <div class="result-value" id="fps">-</div>
                    <div class="result-unit">FPS</div>
                </div>
                <div class="result-card">
                    <h4>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</h4>
                    <div class="result-value" id="memory-usage">-</div>
                    <div class="result-unit">KB</div>
                </div>
                <div class="result-card">
                    <h4>ç«‹æ–¹ä½“æ•°</h4>
                    <div class="result-value" id="cube-count">8</div>
                    <div class="result-unit">å€‹</div>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>ğŸ”§ æŠ€è¡“ä»•æ§˜</h2>
            <ul>
                <li><strong>ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°</strong>: Canvas 2D API</li>
                <li><strong>ã‚¸ã‚ªãƒ¡ãƒˆãƒª</strong>: å…­è§’å½¢ + å¹³è¡Œå››è¾ºå½¢ã«ã‚ˆã‚‹æ“¬ä¼¼3D</li>
                <li><strong>è‰²èª¿æ•´</strong>: çŸ¥è¦šè¼åº¦ãƒ™ãƒ¼ã‚¹ã®æ˜æš—å·®ï¼ˆ120% / 100% / 70%ï¼‰</li>
                <li><strong>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</strong>: ã‚°ãƒªãƒƒãƒ‰é…ç½® / å††å½¢é…ç½® / ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ</li>
                <li><strong>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³</strong>: ãƒ›ãƒãƒ¼æ¤œå‡º / è‰²æƒ…å ±è¡¨ç¤º</li>
                <li><strong>æœ€é©åŒ–</strong>: ãƒ‡ãƒã‚¤ã‚¹ãƒ”ã‚¯ã‚»ãƒ«æ¯”å¯¾å¿œ / ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š</li>
            </ul>
        </div>
    </div>

    <div id="color-info"></div>

    <script type="module">
        import { 
            Canvas2DCubeDemo, 
            PerformanceTestDemo,
            generateSamplePalette 
        } from './src/demo.js';

        // ãƒ‡ãƒ¢åˆæœŸåŒ–
        const demo = new Canvas2DCubeDemo('demo-canvas');
        const perfTest = new PerformanceTestDemo('demo-canvas');
        
        // åˆæœŸãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        demo.startGridDemo();

        // ãƒœã‚¿ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆ
        document.getElementById('grid-layout').addEventListener('click', () => {
            demo.stopAnimation();
            demo.startGridDemo();
            updateAnimationButtons(false);
        });

        document.getElementById('circular-layout').addEventListener('click', () => {
            demo.stopAnimation();
            demo.startCircularDemo();
            updateAnimationButtons(false);
        });

        document.getElementById('animated-demo').addEventListener('click', () => {
            demo.startAnimatedDemo();
            updateAnimationButtons(true);
        });

        document.getElementById('stop-animation').addEventListener('click', () => {
            demo.stopAnimation();
            updateAnimationButtons(false);
        });

        document.getElementById('random-palette').addEventListener('click', () => {
            const randomColors = Array(8).fill(null).map(() => ({
                r: Math.floor(Math.random() * 256),
                g: Math.floor(Math.random() * 256),
                b: Math.floor(Math.random() * 256),
                brightness: Math.random()
            }));
            demo.updatePalette(randomColors);
            document.getElementById('cube-count').textContent = randomColors.length;
        });

        document.getElementById('performance-test').addEventListener('click', async () => {
            const button = document.getElementById('performance-test');
            button.textContent = 'æ¸¬å®šä¸­...';
            button.disabled = true;

            try {
                const result = await perfTest.testLargeScale(100);
                
                document.getElementById('render-time').textContent = result.renderTime.toFixed(1);
                document.getElementById('fps').textContent = result.fps.toFixed(1);
                document.getElementById('memory-usage').textContent = (result.memoryUsage / 1024).toFixed(1);
                document.getElementById('cube-count').textContent = '100';
                
                setTimeout(() => {
                    demo.startGridDemo(); // å…ƒã®è¡¨ç¤ºã«æˆ»ã™
                    document.getElementById('cube-count').textContent = '8';
                }, 1000);
                
            } catch (error) {
                console.error('Performance test failed:', error);
                alert('æ€§èƒ½ãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
            } finally {
                button.textContent = 'æ€§èƒ½ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ';
                button.disabled = false;
            }
        });

        function updateAnimationButtons(isAnimating) {
            document.getElementById('animated-demo').disabled = isAnimating;
            document.getElementById('stop-animation').disabled = !isAnimating;
        }

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
        document.addEventListener('keydown', (event) => {
            switch (event.key) {
                case '1':
                    document.getElementById('grid-layout').click();
                    break;
                case '2':
                    document.getElementById('circular-layout').click();
                    break;
                case '3':
                    document.getElementById('animated-demo').click();
                    break;
                case 'r':
                case 'R':
                    document.getElementById('random-palette').click();
                    break;
                case 'p':
                case 'P':
                    document.getElementById('performance-test').click();
                    break;
                case 'Escape':
                    document.getElementById('stop-animation').click();
                    break;
            }
        });

        console.log('ğŸ¨ Canvas 2D å…­è§’å½¢ç«‹æ–¹ä½“ãƒ‡ãƒ¢ãŒèµ·å‹•ã—ã¾ã—ãŸ');
        console.log('ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ: 1=ã‚°ãƒªãƒƒãƒ‰, 2=å††å½¢, 3=ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³, R=ãƒ©ãƒ³ãƒ€ãƒ , P=æ€§èƒ½ãƒ†ã‚¹ãƒˆ, ESC=åœæ­¢');
    </script>
</body>
</html>